<div class="auth-page">
  <div class="auth-container">
    <div class="auth-card single-column">
      
      <div class="auth-header">
        <div class="brand-mini">
          <div class="brand-logo">FT</div>
          <span class="brand-text">FoodTrace</span>
        </div>
        <div class="lang-select-wrapper">
          <select 
            [ngModel]="currentLang" 
            (ngModelChange)="setLang($event)" 
            class="lang-dropdown"
          >
            <option value="vi">Tiếng Việt</option>
            <option value="en">English</option>
          </select>
        </div>
      </div>

      <div *ngIf="step === 1">
        <h1>{{ 'AUTH.FORGOT.TITLE' | translate }}</h1>
        <p class="subtitle">{{ 'AUTH.FORGOT.SUBTITLE' | translate }}</p>

        <form class="auth-form" (ngSubmit)="sendCode()">
          <div class="input-group">
            <label>{{ 'AUTH.FORGOT.EMAIL' | translate }}</label>
            <input 
              type="email" 
              name="email" 
              [(ngModel)]="email" 
              required 
              placeholder="name@company.com" 
            />
          </div>

          <div class="error" *ngIf="errorMessage">{{ errorMessage }}</div>

          <button type="submit" class="btn-primary" [disabled]="isLoading">
            {{ isLoading ? ('COMMON.LOADING' | translate) : ('AUTH.FORGOT.BUTTON_SEND' | translate) }}
          </button>
        </form>
      </div>

      <div *ngIf="step === 2 && !successMessage">
        <h1>{{ 'AUTH.FORGOT.STEP2_TITLE' | translate }}</h1>
        <p class="subtitle">
          {{ 'AUTH.FORGOT.STEP2_SUBTITLE' | translate }} <br>
          <strong>{{ email }}</strong>
        </p>

        <form class="auth-form" (ngSubmit)="resetPassword()">
          <div class="input-group">
            <label>{{ 'AUTH.FORGOT.LABEL_CODE' | translate }}</label>
            <input 
              type="text" 
              name="otpCode" 
              [(ngModel)]="otpCode" 
              required 
              placeholder="------" 
              style="text-align: center; letter-spacing: 4px; font-weight: bold;"
            />
          </div>

          <div class="input-group">
            <label>{{ 'AUTH.FORGOT.LABEL_NEW_PASS' | translate }}</label>
            <input 
              type="password" 
              name="newPassword" 
              [(ngModel)]="newPassword" 
              required 
              placeholder="••••••••" 
            />
          </div>

          <div class="input-group">
            <label>{{ 'AUTH.FORGOT.LABEL_CONFIRM_PASS' | translate }}</label>
            <input 
              type="password" 
              name="confirmPassword" 
              [(ngModel)]="confirmPassword" 
              required 
              placeholder="••••••••" 
            />
          </div>

          <div class="error" *ngIf="errorMessage">{{ errorMessage }}</div>

          <button type="submit" class="btn-primary" [disabled]="isLoading">
            {{ isLoading ? ('COMMON.LOADING' | translate) : ('AUTH.FORGOT.BUTTON_RESET' | translate) }}
          </button>
        </form>
      </div>

      <div class="success-msg" *ngIf="successMessage">
        <div style="font-size: 40px; margin-bottom: 10px;">✅</div>
        <h3>{{ 'AUTH.FORGOT.SUCCESS' | translate }}</h3>
      </div>

      <div class="auth-footer">
        <a routerLink="/login" class="link-back">
          ← {{ 'AUTH.FORGOT.BACK' | translate }}
        </a>
      </div>

    </div>
  </div>
</div>